{"version":3,"sources":["client/components/AuthenticatedComponent.js"],"names":["requireAuthentication","Component","visitorId","state","user","uid","isAuthenticated","isLogin","changeMenuItem","loginActions","logoutActions","props","componentWillMount","checkAuth","componentWillReceiveProps","pathname","location","isOpenPage","includes","email","password","history","replace","render","React","PureComponent","propTypes","PropTypes","number","bool","object","dispatch","func"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;QAMgBA,qB,GAAAA,qB;;AANhB;;;;AACA;;AACA;;;;AACA;;AACA;;;;AAEO,SAASA,qBAAT,CAA+BC,SAA/B,EAA0C;AAAA;;AAC/C,gBAAQ,yBACN,iBAAS;AACP,WAAO;AACLC,iBAAWC,MAAMC,IAAN,CAAWF,SADjB;AAELG,WAAKF,MAAMC,IAAN,CAAWC,GAFX;AAGLC,uBAAiBH,MAAMC,IAAN,CAAWG;AAHvB,KAAP;AAKD,GAPK,EAQN;AACEC,wCADF;AAEEC,oCAFF,EAEgBC;AAFhB,GARM,CAAR;AAAA;;AAcE,oCAAYC,KAAZ,EAAmB;AAAA;AAAA,4DACjB,gCAAMA,KAAN,CADiB;AAElB;;AAhBH,qCA4BEC,kBA5BF,iCA4BuB;AACnB,WAAKC,SAAL;AACD,KA9BH;;AAAA,qCA+BEC,yBA/BF,wCA+B8B;AAC1B,WAAKD,SAAL;AACD,KAjCH;;AAAA,qCAkCQA,SAlCR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmCUE,wBAnCV,GAmCqB,KAAKJ,KAAL,CAAWK,QAAX,CAAoBD,QAnCzC;AAoCUE,0BApCV,GAoCuBF,SAASG,QAAT,CAAkB,SAAlB,CApCvB;;AAAA,sBAsCQ,CAAC,KAAKP,KAAL,CAAWL,eAAZ,IAA+BW,UAtCvC;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAuCY,KAAKN,KAAL,CAAWF,YAAX,CAAwB,EAAEU,OAAO,kBAAT,EAA6BC,UAAU,QAAvC,EAAxB,CAvCZ;;AAAA;AAAA;AAAA;;AAAA;AAAA,sBAwCe,CAACH,UAAD,IAAe,KAAKN,KAAL,CAAWN,GAAX,KAAmB,KAAKM,KAAL,CAAWT,SAxC5D;AAAA;AAAA;AAAA;;AAyCM,qBAAKS,KAAL,CAAWU,OAAX,CAAmBC,OAAnB,CAA2B,GAA3B;AACA,qBAAKX,KAAL,CAAWH,cAAX,CAA0B,GAA1B;AA1CN;AAAA,uBA2CY,KAAKG,KAAL,CAAWD,aAAX,EA3CZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,qCA+CEa,MA/CF,qBA+CW;AACP,aAAO;AAAA;AAAA;AAAM,aAAKZ,KAAL,CAAWL,eAAX,GAA6B,8BAAC,SAAD,EAAe,KAAKK,KAApB,CAA7B,GAA6D;AAAnE,OAAP;AACD,KAjDH;;AAAA;AAAA,IAaqCa,gBAAMC,aAb3C,WAiBSC,SAjBT,GAiBqB;AACjBxB,eAAWyB,oBAAUC,MADJ;AAEjBvB,SAAKsB,oBAAUC,MAFE;AAGjBtB,qBAAiBqB,oBAAUE,IAHV;AAIjBb,cAAUW,oBAAUG,MAJH;AAKjBC,cAAUJ,oBAAUK,IALH;AAMjBX,aAASM,oBAAUG,MANF;AAOjBtB,oBAAgBmB,oBAAUK,IAPT;AAQjBvB,kBAAckB,oBAAUK,IARP;AASjBtB,mBAAeiB,oBAAUK;AATR,GAjBrB;AAmDD","file":"AuthenticatedComponent.js","sourceRoot":"/Users/lee/Project/analysys/yapi/vendors","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { changeMenuItem } from '../reducer/modules/menu';\nimport { loginActions, logoutActions } from '../reducer/modules/user';\n\nexport function requireAuthentication(Component) {\n  return @connect(\n    state => {\n      return {\n        visitorId: state.user.visitorId,\n        uid: state.user.uid,\n        isAuthenticated: state.user.isLogin\n      };\n    },\n    {\n      changeMenuItem,\n      loginActions, logoutActions\n    }\n  )\n  class AuthenticatedComponent extends React.PureComponent {\n    constructor(props) {\n      super(props);\n    }\n    static propTypes = {\n      visitorId: PropTypes.number,\n      uid: PropTypes.number,\n      isAuthenticated: PropTypes.bool,\n      location: PropTypes.object,\n      dispatch: PropTypes.func,\n      history: PropTypes.object,\n      changeMenuItem: PropTypes.func,\n      loginActions: PropTypes.func,\n      logoutActions: PropTypes.func\n    };\n    componentWillMount() {\n      this.checkAuth();\n    }\n    componentWillReceiveProps() {\n      this.checkAuth();\n    }\n    async checkAuth() {\n      const pathname = this.props.location.pathname\n      const isOpenPage = pathname.includes('project')\n\n      if (!this.props.isAuthenticated && isOpenPage) {\n        await this.props.loginActions({ email: '877286986@qq.com', password: '123456' })\n      } else if (!isOpenPage && this.props.uid === this.props.visitorId) {\n        this.props.history.replace('/');\n        this.props.changeMenuItem('/');\n        await this.props.logoutActions();\n\n      }\n    }\n    render() {\n      return <div>{this.props.isAuthenticated ? <Component {...this.props} /> : null}</div>;\n    }\n  };\n}\n"]}